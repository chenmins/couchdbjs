<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Couchdbjs : A node client for couchdb.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Couchdbjs</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/prateekkumarweb/couchdbjs">View on GitHub</a>

          <h1 id="project_title">Couchdbjs</h1>
          <h2 id="project_tagline">A node client for couchdb.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/prateekkumarweb/couchdbjs/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/prateekkumarweb/couchdbjs/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="couchdbjs" class="anchor" href="#couchdbjs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>couchdbjs</h1>

<p>couchdbjs is node.js client for couchdb.</p>

<p><a href="https://nodei.co/npm/couchdbjs/"><img src="https://nodei.co/npm/couchdbjs.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM"></a></p>

<p><img src="https://img.shields.io/npm/v/couchdbjs.svg?style=flat-square" alt="npm">
<img src="https://img.shields.io/npm/dm/couchdbjs.svg?style=flat-square" alt="npm">
<img src="https://img.shields.io/npm/dt/couchdbjs.svg?style=flat-square" alt="npm">
<img src="https://img.shields.io/npm/l/couchdbjs.svg?style=flat-square" alt="npm">
<img src="https://david-dm.org/prateekkumarweb/couchdbjs.svg?style=flat-square" alt="Dependencies"></p>

<h3>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install</h3>

<div class="highlight highlight-source-shell"><pre>$ npm install couchdbjs --save</pre></div>

<h3>
<a id="create-a-couchdbjs-object" class="anchor" href="#create-a-couchdbjs-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a couchdbjs object</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">const</span> <span class="pl-c1">Couchdbjs</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>couchdbjs<span class="pl-pds">'</span></span>);
<span class="pl-k">const</span> <span class="pl-c1">db</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Couchdbjs</span>(dbname, options, callback);</pre></div>

<p>Note : Here DB is the object of the class couchdbjs.</p>

<p>Here <code>options</code> is an optional js object containing the configuration.
This is the default configuration.</p>

<div class="highlight highlight-source-js"><pre>{
    protocol <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http:<span class="pl-pds">'</span></span>,
    hostname<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
    port<span class="pl-k">:</span> <span class="pl-c1">5984</span>
}</pre></div>

<p><code>dbname</code> is the name of the database.</p>

<h3>
<a id="generate-a-new-uuid" class="anchor" href="#generate-a-new-uuid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate a new uuid</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Couchdbjs</span>.<span class="pl-en">getNewId</span>(options, cb);</pre></div>

<p>Here <code>options</code> is optional configuration object.
This is the default configuration.</p>

<div class="highlight highlight-source-js"><pre>{
    protocol <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http:<span class="pl-pds">'</span></span>,
    hostname <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
    port<span class="pl-k">:</span> <span class="pl-c1">5984</span>
    count <span class="pl-k">:</span> <span class="pl-c1">1</span>
}</pre></div>

<p><code>cb</code> is reqired callback function with two parameters <code>err</code> and <code>data</code>.
To avoid writing configurations for protocol, hostname and port again the function <code>getConfig</code> can be called on existing database object.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getConfig</span>({count <span class="pl-k">:</span> <span class="pl-c1">1</span>});</pre></div>

<p>returns</p>

<div class="highlight highlight-source-js"><pre>{
    protocol <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http:<span class="pl-pds">'</span></span>,
    hostname <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
    port<span class="pl-k">:</span> <span class="pl-c1">5984</span>
    count <span class="pl-k">:</span> <span class="pl-c1">1</span>
}</pre></div>

<p>Complete Example :</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Couchdbjs</span>.<span class="pl-en">getNewId</span>(<span class="pl-smi">db</span>.<span class="pl-en">getConfig</span>({count <span class="pl-k">:</span> <span class="pl-c1">1</span>}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data[<span class="pl-c1">0</span>]); <span class="pl-c">// data is array of uuids</span>
}));</pre></div>

<h3>
<a id="create-a-new-database" class="anchor" href="#create-a-new-database" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a new database</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// not recommended</span>
<span class="pl-k">const</span> <span class="pl-c1">db</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Couchdbjs</span>(<span class="pl-s"><span class="pl-pds">'</span>dbname<span class="pl-pds">'</span></span>, options);</pre></div>

<p>This creates a database when a database with name <code>dbname</code> doesn't exist.
Database can also be created using <code>Couchdbjs.createDB</code> function.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// recommended</span>
<span class="pl-smi">Couchdbjs</span>.<span class="pl-en">createDB</span>({
    protocol<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http:<span class="pl-pds">'</span></span>,
    hostname<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
    port<span class="pl-k">:</span> <span class="pl-c1">5984</span>,
    db<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>dbanme<span class="pl-pds">'</span></span>
}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>)=&gt;{
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<h3>
<a id="delete-a-database" class="anchor" href="#delete-a-database" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Delete a database</h3>

<p>Database can be deleted using function <code>Couchdbjs.deleteDB</code> similar to <code>Couchdbjs.createDB</code>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Couchdbjs</span>.<span class="pl-en">deleteDB</span>({
    protocol<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http:<span class="pl-pds">'</span></span>,
    hostname<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>localhost<span class="pl-pds">'</span></span>,
    port<span class="pl-k">:</span> <span class="pl-c1">5984</span>,
    db<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>dbanme<span class="pl-pds">'</span></span>
}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});
</pre></div>

<h3>
<a id="list-all-documents-in-a-database" class="anchor" href="#list-all-documents-in-a-database" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>List all documents in a database</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getAllDocs</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<h3>
<a id="create-a-new-document" class="anchor" href="#create-a-new-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a new document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">createDoc</span>(id, <span class="pl-c1">document</span>, cb);</pre></div>

<p><code>id</code> is the id of the document to be used.
<code>document</code> is the object to be stored in the document.
<code>cb</code> is the callback function with parameters <code>err</code> and <code>data</code>.
Example</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">createDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, {a<span class="pl-k">:</span><span class="pl-c1">1</span>, b<span class="pl-k">:</span><span class="pl-c1">2</span>, c<span class="pl-k">:</span>[<span class="pl-c1">5</span>, <span class="pl-s"><span class="pl-pds">'</span>k<span class="pl-pds">'</span></span>]}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<h3>
<a id="get-document" class="anchor" href="#get-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getDoc</span>(id, cb);</pre></div>

<p><code>id</code> is the id of the document.
<code>cb</code> is the callback function with parameters <code>err</code> and <code>data</code>.
Example</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<h3>
<a id="update-a-document" class="anchor" href="#update-a-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Update a document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">updateDoc</span>(id, doc, cb);</pre></div>

<p><code>id</code>, <code>doc</code>, <code>cb</code> are id of document to be updated, document object with filed to be updated and callback function with parameters <code>err</code> and <code>data</code> respectively.
Example
Suppose this a document already present</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>_rev<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>1-1357<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>asd<span class="pl-pds">'</span></span>
}</pre></div>

<p>If the following function is used to update the document</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">upadteDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, {b<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cs<span class="pl-pds">'</span></span>, c<span class="pl-k">:</span> <span class="pl-c1">5</span>}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {});</pre></div>

<p>then the final document will be</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>_rev<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>2-2468<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cs<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-c1">5</span>
}</pre></div>

<p>After that if the following function is used to update the document</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">upadteDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, {b<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cse<span class="pl-pds">'</span></span>, a<span class="pl-k">:</span> <span class="pl-c1">undefined</span>}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {});</pre></div>

<p>then the final document will be</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>_rev<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>3-3579<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cse<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-c1">5</span>
}</pre></div>

<p>To update whole document by overwriting the existing one use</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">createDoc</span>(id, doc, cb);</pre></div>

<p>with <code>_rev</code> field in the <code>doc</code> document.</p>

<h3>
<a id="delete-a-document" class="anchor" href="#delete-a-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Delete a document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">deleteDoc</span>(id, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<h3>
<a id="attach-files-to-a-document" class="anchor" href="#attach-files-to-a-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Attach files to a document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">attachFileToDoc</span>(id, rev, file, cb);</pre></div>

<p>Example</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">attachFileToDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>3-3579<span class="pl-pds">'</span></span>, {
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>pic.jpg<span class="pl-pds">'</span></span>,
    path<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/home/user/image.jpg<span class="pl-pds">'</span></span>
    mimetype<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>image/jpeg<span class="pl-pds">'</span></span>
}, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>

<p>Here the file gets uploaded to <a href="http://localhost:5984/db_name/id_doc/pic.jpg">http://localhost:5984/db_name/id_doc/pic.jpg</a>.</p>

<h3>
<a id="delete-attachment-from-document" class="anchor" href="#delete-attachment-from-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Delete attachment from document</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">deleteAttachment</span>(id, rev, attachmentName, cb);</pre></div>

<p>Example</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">attachFileToDoc</span>(<span class="pl-s"><span class="pl-pds">'</span>id_doc<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>4-1579<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>pic.jpg<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">error</span>(err);
    <span class="pl-k">else</span> <span class="pl-en">console</span>.<span class="pl-c1">log</span>(data);
});</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Couchdbjs maintained by <a href="https://github.com/prateekkumarweb">prateekkumarweb</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
